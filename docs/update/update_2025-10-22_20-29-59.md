# EDMO Pipeline Update â€“ Oct 22, 2025

## What's Working Now

The full pipeline is live: **ASR â†’ NLP â†’ Emotion â†’ Clustering â†’ Visualization**. Everything runs end-to-end, Docker builds are clean, and we're generating actual charts per session.

---

## Changes

### Visualization Service

**New automated chart generation** using Matplotlib with headless rendering for Docker compatibility.

- Radar charts show emotional distribution per cluster
- Timeline charts track emotion flow across the session
- Auto-creates session directories before saving outputs
- Accepts `output_dir` parameter for organized file management

Output structure:

```
data/outputs/session_20251022-195218/
â”œâ”€â”€ windows.json
â”œâ”€â”€ clusters.json
â”œâ”€â”€ timeline.png
â””â”€â”€ radar.png
```

### Go Pipeline

**Better observability and error handling**

- Enhanced logging with service URLs, window counts, and feature dimensions
- Integrated `output_dir` parameter throughout the pipeline
- Refactored session persistence logic
- Added safety checks to skip clustering when insufficient data

### Clustering Service

**More robust fuzzy c-means implementation**

- Dynamic PCA component reduction when sample size is limited
- Stable output with `cluster_labels` and `membership_matrix`
- Better handling of edge cases

### Infrastructure

**All services containerized and functional**

Docker Compose now brings up 6 services cleanly:

- ASR
- NLP
- Emotion
- Diarization
- Clustering
- Visualization

Updated Python dependencies: `matplotlib`, `numpy`, etc.

---

## Running It

```bash
CONFIG_ENV=dev go run ./src/go_core ./data/processed/audio/jfk.wav
```

Expected output:

```
ðŸ“¦ saved: data/outputs/session_20251022-195218/windows.json
ðŸ“¦ saved: data/outputs/session_20251022-195218/clusters.json
ðŸ–¼ radar: data/outputs/session_20251022-195218/radar.png
ðŸ–¼ timeline: data/outputs/session_20251022-195218/timeline.png
```

---

## Up Next

- **Robot metrics integration** â€“ waiting on data format specs
- **Timeline overlays** â€“ add robot progress bars to emotion timelines
- **Speaker diarization** â€“ match utterances to specific speakers

---

**Status**: Production-ready for audio analysis. Waiting on robot data format to complete the therapy session visualization.
